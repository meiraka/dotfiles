#!/bin/bash

if [ ! -L "$0" ]; then
  echo dotfiles is not installed
  exit 1
fi
ROOT=$(cd $(dirname "$(readlink "$0")"); cd ../..; pwd)

cd ${ROOT}

ARGS=()
ARGS+=${@##${HOME}/.}

# add checks files are exists in git repository.
add() {
    first=1
    for i in $@; do
        if [ "$first" != "1" ]; then
            if [ ! -e $i ]; then
                echo ~/.$i is not under dotfiles repository
                exit 1
            fi
        fi
        first=0
    done
}


if [ "$#" = 0 ]; then
    git
elif [ "$1" = "add" ]; then
    add $ARGS
fi
git $ARGS
